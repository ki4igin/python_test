# This is a sample Python script.

# Press Shift+F10 to execute it or replace it with your code.
# Press Double Shift to search everywhere for classes, files, tool windows, actions, and settings.

import pandas as pd
import numpy as np
from matplotlib import pyplot as plt


def print_hi(name):
    # Use a breakpoint in the code line below to debug your script.
    print(f'Hi, {name}')  # Press Ctrl+F8 to toggle the breakpoint.


# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    print_hi('PyCharm')

t_table = {
    'N': [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 40,
          50, 60, 80, 100, 120, 150],
    '0.90': [2.353, 2.132, 2.015, 1.943, 1.895, 1.860, 1.833, 1.812, 1.796, 1.782, 1.771, 1.761, 1.753, 1.746, 1.740,
             1.734, 1.729, 1.725, 1.721, 1.717, 1.714, 1.711, 1.708, 1.706, 1.703, 1.701, 1.699, 1.697, 1.684, 1.676,
             1.671, 1.664, 1.660, 1.658, 1.645],
    '0.95': [3.182, 2.776, 2.571, 2.447, 2.365, 2.306, 2.262, 2.228, 2.201, 2.179, 2.160, 2.145, 2.131, 2.120, 2.110,
             2.101, 2.093, 2.086, 2.080, 2.074, 2.069, 2.064, 2.060, 2.056, 2.052, 2.048, 2.045, 2.042, 2.021, 2.009,
             2.000, 1.990, 1.984, 1.980, 1.960],
    '0.98': [4.541, 3.747, 3.365, 3.143, 2.998, 2.896, 2.821, 2.764, 2.718, 2.681, 2.650, 2.624, 2.602, 2.583, 2.567,
             2.552, 2.539, 2.528, 2.518, 2.508, 2.500, 2.492, 2.485, 2.479, 2.473, 2.467, 2.462, 2.457, 2.423, 2.403,
             2.390, 2.374, 2.364, 2.358, 2.326, ],
    '0.99': [5.841, 4.604, 4.032, 3.707, 3.499, 3.355, 3.250, 3.169, 3.106, 3.055, 3.012, 2.977, 2.947, 2.921, 2.898,
             2.878, 2.861, 2.845, 2.831, 2.819, 2.807, 2.797, 2.787, 2.779, 2.771, 2.763, 2.756, 2.750, 2.704, 2.678,
             2.660, 2.639, 2.626, 2.617, 2.576, ],
    '0.995': [7.453, 5.598, 4.773, 4.317, 4.029, 3.833, 3.690, 3.581, 3.497, 3.428, 3.372, 3.326, 3.286, 3.252, 3.222,
              3.197, 3.174, 3.153, 3.135, 3.119, 3.104, 3.091, 3.078, 3.067, 3.057, 3.047, 3.038, 3.030, 2.971, 2.937,
              2.915, 2.887, 2.871, 2.860, 2.807, ],
    '0.999': [12.92, 8.610, 6.869, 5.959, 5.408, 5.041, 4.781, 4.587, 4.437, 4.318, 4.221, 4.140, 4.073, 4.015, 3.965,
              3.922, 3.883, 3.850, 3.819, 3.792, 3.767, 3.745, 3.725, 3.707, 3.690, 3.674, 3.659, 3.646, 3.551, 3.496,
              3.460, 3.416, 3.390, 3.373, 3.29]
}

def get_t(n: int, P='0.95') -> int:
    n_array = np.array(t_table['N'])
    idx = np.argmin(np.abs(n_array - n))
    return idx

data = pd.read_excel('СМ5-31Б_ЛР1_Никулина_ЗЕ_Василенко_ВД.xlsx', index_col=None, skiprows=1)

print(get_t(20))


# print(data.keys())
#
# print(data.loc[:, 'R2WR, Ом'])
#
# r2wr = data.loc[:, 'R2WR, Ом'].to_numpy()
#
# marks = r2wr
# fig, axis = plt.subplots()
# axis.hist(marks)
# # Displaying the graph
# plt.show()
